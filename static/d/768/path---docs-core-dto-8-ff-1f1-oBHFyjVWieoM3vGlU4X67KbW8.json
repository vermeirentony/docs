{"pageContext":{"html":"<h1 id=\"using-data-transfer-objects-dtos\"><a href=\"#using-data-transfer-objects-dtos\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using Data Transfer Objects (DTOs)</h1>\n<h2 id=\"specifying-an-input-or-an-output-data-representation\"><a href=\"#specifying-an-input-or-an-output-data-representation\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Specifying an Input or an Output Data Representation</h2>\n<p>For a given resource class, you may want to have a different representation of this class as input (write) or output (read).\nTo do so, a resource can take an input and/or an output class:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// api/src/Entity/Book.php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Entity</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">ApiPlatform<span class=\"token punctuation\">\\</span>Core<span class=\"token punctuation\">\\</span>Annotation<span class=\"token punctuation\">\\</span>ApiResource</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Dto<span class=\"token punctuation\">\\</span>BookInput</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Dto<span class=\"token punctuation\">\\</span>BookOutput</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * @ApiResource(\n *   input=BookInput::class,\n *   output=BookOutput::class\n * )\n */</span>\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Book</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>The <code class=\"language-text\">input</code> attribute is used during <a href=\"/docs/core/serialization/\">the deserialization process</a>, when transforming the user-provided data to a resource instance.\nSimilarly, the <code class=\"language-text\">output</code> attribute is used during <a href=\"/docs/core/serialization/\">the serialization process</a>. This class represents how the <code class=\"language-text\">Book</code> resource will be represented in the <code class=\"language-text\">Response</code>.</p>\n<p>The <code class=\"language-text\">input</code> and <code class=\"language-text\">output</code> attributes are taken into account by all the documentation generators (GraphQL and OpenAPI, Hydra).</p>\n<p>To create a <code class=\"language-text\">Book</code>, we <code class=\"language-text\">POST</code> a data structure corresponding to the <code class=\"language-text\">BookInput</code> class and get back in the response a data structure corresponding to the <code class=\"language-text\">BookOutput</code> class:</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e4bd7fb6c668985dae710dfca1deac7a/74d46/api-platform-post-i-o.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 1091px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 30.980751604032996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABhElEQVQY02OI+v2fMeLLfya///8Z/v9fx/Dk/27GW/83MjIAwZH/cxnUjJUExWXERHUkORgfHjRkPrNelxkkN/V1LePb/wcZz/yfD+Iy2M1ZymS7YCVYDiuQUZdgxCkZGYbCPY/MMeudFms5eU61SHKDYHiliXT2gvDq7AVhBUAployFoWalGxOqUxdHmK5zZGC7uFk/88pW/SRuBgbmtFlBZkC17VlzA+wYmMPY7OYujbVftCaDwWbmohKnxWumSKRUStvnGsnnrcvszFyVUg80kD1jbohv1Za0FWmLIz0bTRl4Lmwxn3plu3kXUI41cEa0Xe669Llh08M8Gdgd+VznL+9wWbJ2OorTb6wzFrk1T9VoW5uKTXuphhQuH4fFa7A83mZkcHyqqvO6Hi23cEcebrhk0KX7TFPOz2IFsfct0fe8ssNq17WdVpt2L9AxAYltuJjKWnEggzFfj4Hh4wVn5v//lzIUxIpwXNlu0XV7v+2mW3ssJ/bVavIBY5Qh7/guZgAYh43oABOkZAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Diagram post input output\"\n        title=\"\"\n        src=\"/static/e4bd7fb6c668985dae710dfca1deac7a/74d46/api-platform-post-i-o.png\"\n        srcset=\"/static/e4bd7fb6c668985dae710dfca1deac7a/d902d/api-platform-post-i-o.png 280w,\n/static/e4bd7fb6c668985dae710dfca1deac7a/a0695/api-platform-post-i-o.png 560w,\n/static/e4bd7fb6c668985dae710dfca1deac7a/74d46/api-platform-post-i-o.png 1091w\"\n        sizes=\"(max-width: 1091px) 100vw, 1091px\"\n      />\n  </span>\n  </a></p>\n<p>To simplify object transformations we have to implement a Data Transformer that will convert the input into a resource or a resource into an output.</p>\n<p>We have the following <code class=\"language-text\">BookInput</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// src/Dto/BookInput.php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Dto</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BookInput</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span> <span class=\"token variable\">$isbn</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>We can transform the <code class=\"language-text\">BookInput</code> to a <code class=\"language-text\">Book</code> resource instance:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// src/DataTransformer/BookInputDataTransformer.php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>DataTransformer</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">ApiPlatform<span class=\"token punctuation\">\\</span>Core<span class=\"token punctuation\">\\</span>DataTransformer<span class=\"token punctuation\">\\</span>DataTransformerInterface</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Dto<span class=\"token punctuation\">\\</span>BookInput</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BookInputDataTransformer</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">DataTransformerInterface</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * {@inheritdoc}\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">transform</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">,</span> string <span class=\"token variable\">$to</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span> <span class=\"token variable\">$context</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$book</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Book</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$book</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">isbn</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$data</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">isbn</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$book</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * {@inheritdoc}\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">supportsTransformation</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">,</span> string <span class=\"token variable\">$to</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span> <span class=\"token variable\">$context</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> bool\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// in the case of an input, the value given here is an array (the JSON decoded).</span>\n        <span class=\"token comment\">// if it's a book we transformed the data already</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span> <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Book</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> Book<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">class</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$to</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">!==</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$context</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'input'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'class'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>We now register it:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># api/config/services.yaml</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># ...</span>\n    <span class=\"token key atrule\">'App\\DataTransformer\\BookInputDataTransformer'</span><span class=\"token punctuation\">:</span> <span class=\"token null important\">~</span>\n        <span class=\"token comment\"># Uncomment only if autoconfiguration is disabled</span>\n        <span class=\"token comment\">#tags: [ 'api_platform.data_transformer' ]</span></code></pre></div>\n<p>To manage the output, it's exactly the same process. For example, we have the following <code class=\"language-text\">BookOutput</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// src/Dto/BookOutput.php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Dto</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BookOutput</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>We can transform the <code class=\"language-text\">Book</code> to a <code class=\"language-text\">BookOutput</code> object:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// src/DataTransformer/BookOutputDataTransformer.php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>DataTransformer</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">ApiPlatform<span class=\"token punctuation\">\\</span>Core<span class=\"token punctuation\">\\</span>DataTransformer<span class=\"token punctuation\">\\</span>DataTransformerInterface</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Dto<span class=\"token punctuation\">\\</span>BookOutput</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Entity<span class=\"token punctuation\">\\</span>Book</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BookOutputDataTransformer</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">DataTransformerInterface</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * {@inheritdoc}\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">transform</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">,</span> string <span class=\"token variable\">$to</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span> <span class=\"token variable\">$context</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$output</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BookOutput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$output</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$data</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$output</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * {@inheritdoc}\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">supportsTransformation</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">,</span> string <span class=\"token variable\">$to</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span> <span class=\"token variable\">$context</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> bool\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> BookOutput<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">class</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$to</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$data</span> <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Book</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>We now register it:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># api/config/services.yaml</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># ...</span>\n    <span class=\"token key atrule\">'App\\DataTransformer\\BookOutputDataTransformer'</span><span class=\"token punctuation\">:</span> <span class=\"token null important\">~</span>\n        <span class=\"token comment\"># Uncomment only if autoconfiguration is disabled</span>\n        <span class=\"token comment\">#tags: [ 'api_platform.data_transformer' ]</span></code></pre></div>\n<h2 id=\"updating-a-resource-with-a-custom-input\"><a href=\"#updating-a-resource-with-a-custom-input\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Updating a Resource with a Custom Input</h2>\n<p>When performing an update (e.g. <code class=\"language-text\">PUT</code> operation), the resource to be updated is read by ApiPlatform before the deserialization phase. To do so, it uses a <a href=\"/docs/core/data-providers/\">data provider</a> with the <code class=\"language-text\">:id</code> parameter given in the URL. The <em>body</em> of the request is the JSON object sent by the client, it is deserialized and is used to update the previously found resource.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8b42670f32534af2d85c091c50f8e705/9d7c7/api-platform-put-i-o.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 1120px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 21.51394422310757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAABCklEQVQY02MQcHBlFvf0Y2aAAkkGBkY5KFtO04hBlYGBSRsoJiEsxAUU4mFAApGZfgxGQHlvoDxc0GLqvDzzybOjQOyMFHWeC5uMJpzbYOAL5IIs4Y2fF+ufsSq1QSfRRKRsfUJj6vKE0BPzlI0vbjWZOTOcgT9+WUp+yqLQWN3eleYOsxZNYLCcPCfNYhLEQEtvY5YzG21E9y0xBbmECSS2cYWt9da1DvGT2rXFsjflCxSuS+E9Mk+L48FhJ5HNk5R5gXJR6xZbhmVMreB3XLBBhMG8c6IXEDuBNDNLqzPBXJ4XIw4OhnPrjINvbjevP7HKUJYBDexboi94bat5wbVt5hmXZjJzgMQANhhPh6bN6y0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Diagram put input output\"\n        title=\"\"\n        src=\"/static/8b42670f32534af2d85c091c50f8e705/f066b/api-platform-put-i-o.png\"\n        srcset=\"/static/8b42670f32534af2d85c091c50f8e705/324c3/api-platform-put-i-o.png 280w,\n/static/8b42670f32534af2d85c091c50f8e705/53f37/api-platform-put-i-o.png 560w,\n/static/8b42670f32534af2d85c091c50f8e705/f066b/api-platform-put-i-o.png 1120w,\n/static/8b42670f32534af2d85c091c50f8e705/9d7c7/api-platform-put-i-o.png 1506w\"\n        sizes=\"(max-width: 1120px) 100vw, 1120px\"\n      />\n  </span>\n  </a></p>\n<p>Now, we will update our resource by using a different input representation.</p>\n<p>With the following <code class=\"language-text\">BookInput</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// src/Dto/BookInput.php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Dto</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BookInput</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/**\n   * @var \\App\\Entity\\Author\n   */</span>\n  <span class=\"token keyword\">public</span> <span class=\"token variable\">$author</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>We will implement a <code class=\"language-text\">BookInputDataTransformer</code> that transforms the <code class=\"language-text\">BookInput</code> to our <code class=\"language-text\">Book</code> resource instance. In this case, the <code class=\"language-text\">Book</code> (<code class=\"language-text\">/books/1</code>) already exists, so we will just update it.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// src/DataTransformer/BookInputDataTransformer.php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>DataTransformer</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">ApiPlatform<span class=\"token punctuation\">\\</span>Core<span class=\"token punctuation\">\\</span>DataTransformer<span class=\"token punctuation\">\\</span>DataTransformerInterface</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">ApiPlatform<span class=\"token punctuation\">\\</span>Core<span class=\"token punctuation\">\\</span>Serializer<span class=\"token punctuation\">\\</span>AbstractItemNormalizer</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Dto<span class=\"token punctuation\">\\</span>BookInput</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BookInputDataTransformer</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">DataTransformerInterface</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * {@inheritdoc}\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">transform</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">,</span> string <span class=\"token variable\">$to</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span> <span class=\"token variable\">$context</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$existingBook</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$context</span><span class=\"token punctuation\">[</span>AbstractItemNormalizer<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">OBJECT_TO_POPULATE</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$existingBook</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">author</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$data</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">author</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$existingBook</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * {@inheritdoc}\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">supportsTransformation</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">,</span> string <span class=\"token variable\">$to</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span> <span class=\"token variable\">$context</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> bool\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span> <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Book</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> Book<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">class</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$to</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">!==</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$context</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'input'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'class'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># api/config/services.yaml</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># ...</span>\n    <span class=\"token key atrule\">'App\\DataTransformer\\BookInputDataTransformer'</span><span class=\"token punctuation\">:</span> <span class=\"token null important\">~</span>\n        <span class=\"token comment\"># Uncomment only if autoconfiguration is disabled</span>\n        <span class=\"token comment\">#tags: [ 'api_platform.data_transformer' ]</span></code></pre></div>\n<h2 id=\"disabling-the-input-or-the-output\"><a href=\"#disabling-the-input-or-the-output\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disabling the Input or the Output</h2>\n<p>Both the <code class=\"language-text\">input</code> and the <code class=\"language-text\">output</code> attributes can be set to <code class=\"language-text\">false</code>.\nIf <code class=\"language-text\">input</code> is <code class=\"language-text\">false</code>, the deserialization process will be skipped, and no data persister will be called.\nIf <code class=\"language-text\">output</code> is <code class=\"language-text\">false</code>, the serialization process will be skipped, and no data provider will be called.</p>\n<h2 id=\"inputoutput-metadata\"><a href=\"#inputoutput-metadata\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Input/Output Metadata</h2>\n<p>When specified, <code class=\"language-text\">input</code> and <code class=\"language-text\">output</code> attributes support:</p>\n<ul>\n<li>a string representing the class to use</li>\n<li>a falsy boolean to disable them</li>\n<li>an array to specify more metadata for example <code class=\"language-text\">[&#39;class&#39; =&gt; BookInput::class, &#39;name&#39; =&gt; &#39;BookInput&#39;, &#39;iri&#39; =&gt; &#39;/book_input&#39;]</code></li>\n</ul>\n<h2 id=\"using-objects-as-relations-inside-resources\"><a href=\"#using-objects-as-relations-inside-resources\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using Objects As Relations Inside Resources</h2>\n<p>Because API Platform can (de)normalize anything in the supported formats (<code class=\"language-text\">jsonld</code>, <code class=\"language-text\">jsonapi</code>, <code class=\"language-text\">hal</code>, etc.), you can use any object you want inside resources. For example, let's say that the <code class=\"language-text\">Book</code> has an <code class=\"language-text\">attribute</code> property that can't be represented by a resource, we can do the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// api/src/Entity/Book.php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Entity</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">ApiPlatform<span class=\"token punctuation\">\\</span>Core<span class=\"token punctuation\">\\</span>Annotation<span class=\"token punctuation\">\\</span>ApiResource</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Model<span class=\"token punctuation\">\\</span>Attribute</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * @ApiResource\n */</span>\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Book</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/**\n   * @var Attribute\n   **/</span>\n  <span class=\"token keyword\">public</span> <span class=\"token variable\">$attribute</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token variable\">$isbn</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>The <code class=\"language-text\">Book</code> <code class=\"language-text\">attribute</code> property will now be an instance of <code class=\"language-text\">Attribute</code> after the (de)normalization phase.</p>","editPath":"core/dto.md","title":"Using Data Transfer Objects (DTOs)","previous":{"slug":"/docs/core/messenger/","title":"Symfony Messenger Integration: CQRS and Async Message Processing"},"next":{"slug":"/docs/core/push-relations/","title":"Pushing Related Resources Using HTTP/2"}}}